@model LibraryManagement.ViewModels.BorrowReportViewModel

@{
    ViewData["Title"] = "Báo cáo phiếu quá hạn";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Thống kê mượn sách</h2>
</div>

<form method="get" class="row g-2 mb-3">
    <div class="col-md-3">
        <label class="form-label">Từ ngày</label>
        <input asp-for="FromDate" type="date" name="fromDate" class="form-control" />
    </div>

    <div class="col-md-3">
        <label class="form-label">Đến ngày</label>
        <input asp-for="ToDate" type="date" name="toDate" class="form-control" />
    </div>

    <div class="col-md-3 d-flex align-items-end">
        <div class="form-check">
            <input asp-for="OnlyOverdue" class="form-check-input" type="checkbox" name="onlyOverdue" id="onlyOverdue" />
            <label class="form-check-label" for="onlyOverdue">Chỉ phiếu quá hạn</label>
        </div>
    </div>

    <div class="col-md-3 d-flex align-items-end">
        <button type="submit" class="btn btn-primary me-2">Lọc</button>
        <a class="btn btn-secondary" href="@Url.Action("Index", "ThongKeMuons")">Reset</a>
    </div>
</form>

@if (!Model.Items.Any())
{
    <div class="alert alert-info">Không có dữ liệu.</div>
}
else
{
    <div class="alert alert-success">Tổng lượt: @ViewBag.TongLuotMuon — Tổng sách: @ViewBag.TongSachMuon</div>

    <div class="table-responsive">
        <table class="table table-striped">
            <thead>
            <tr>
                <th>Mã phiếu</th>
                <th>Người mượn</th>
                <th>Ngày mượn</th>
                <th>Hạn trả</th>
                <th>Số ngày trễ</th>
                <th>Quá hạn?</th>
                <th>Số sách</th>
                <th>Tiền phạt</th>
            </tr>
            </thead>
            <tbody>
            @foreach (var r in Model.Items)
            {
                <tr>
                    <td>@r.MaPhieuMuon</td>
                    <td>@r.HoTen (@r.MaNguoiMuon)</td>
                    <td>@r.NgayMuon.ToString("dd/MM/yyyy")</td>
                    <td>@r.HanTra.ToString("dd/MM/yyyy")</td>
                    <td>@r.SoNgayTre</td>
                    <td>@(r.IsOverdue ? "Có" : "Không")</td>
                    <td>@r.SoSachDangMuon</td>
                    <td>@string.Format("{0:N0}", r.TongTienPhatChuaTra)</td>
                </tr>
            }
            </tbody>
        </table>
    </div>
}
